{% extends "base.html" %}

{% block title %}ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | Gold Experience{% endblock %}

{% block content %}
<div style="display: flex; flex-direction: column; gap: 32px;">

    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="glass-card gold-border" style="padding: 32px; text-align: center;">
        <h1 style="font-size: 2.5rem; font-weight: 900; margin-bottom: 8px;">
            <span class="shimmer">Gold Experience</span>
        </h1>
        <p style="color: var(--text-secondary);">åœ°æ”¿å­¦ãƒªã‚¹ã‚¯ Ã— ã‚³ãƒ¢ãƒ‡ã‚£ãƒ†ã‚£ä¾¡æ ¼äºˆæ¸¬ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</p>
    </div>

    <!-- ä¾¡æ ¼ãƒ‘ãƒãƒ« -->
    <div class="grid grid-5">
        <!-- ã‚´ãƒ¼ãƒ«ãƒ‰ -->
        <a href="/gold" class="glass-card price-card gold-border" style="text-decoration: none;">
            <div class="icon">ğŸ¥‡</div>
            <div class="label">Gold / ã‚°ãƒ©ãƒ </div>
            <div class="price gold-gradient">Â¥{{ prices.gold.price_jpy | default('29,815') }}</div>
            <div class="change {{ 'up' if prices.gold.change_pct | default(0) > 0 else 'down' }}">
                {% if prices.gold.change_pct | default(0) > 0 %}+{% endif %}{{ prices.gold.change_pct | default('+1.2') }}%
            </div>
        </a>

        <!-- ã‚·ãƒ«ãƒãƒ¼ -->
        <a href="/silver" class="glass-card price-card silver-border" style="text-decoration: none;">
            <div class="icon">ğŸ¥ˆ</div>
            <div class="label">Silver / ã‚°ãƒ©ãƒ </div>
            <div class="price silver-gradient">Â¥{{ prices.silver.price_jpy | default('644') }}</div>
            <div class="change {{ 'up' if prices.silver.change_pct | default(0) > 0 else 'down' }}">
                {% if prices.silver.change_pct | default(0) > 0 %}+{% endif %}{{ prices.silver.change_pct | default('+2.1') }}%
            </div>
        </a>

        <!-- éŠ… -->
        <a href="/copper" class="glass-card price-card" style="text-decoration: none;">
            <div class="icon">ğŸ”¶</div>
            <div class="label">Copper / ãƒãƒ³ãƒ‰</div>
            <div class="price" style="color: #B87333;">${{ prices.copper.price_usd | default('5.90') }}</div>
            <div class="change {{ 'up' if prices.copper.change_pct | default(0) > 0 else 'down' }}">
                {% if prices.copper.change_pct | default(0) > 0 %}+{% endif %}{{ prices.copper.change_pct | default('+0.3') }}%
            </div>
        </a>

        <!-- WTIåŸæ²¹ -->
        <a href="/oil" class="glass-card price-card" style="text-decoration: none;">
            <div class="icon">ğŸ›¢ï¸</div>
            <div class="label">WTI Crude / ãƒãƒ¬ãƒ«</div>
            <div class="price" style="color: #D2691E;">${{ prices.oil.price_usd | default('78.50') }}</div>
            <div class="change {{ 'up' if prices.oil.change_pct | default(0) > 0 else 'down' }}">
                {% if prices.oil.change_pct | default(0) > 0 %}+{% endif %}{{ prices.oil.change_pct | default('-0.8') }}%
            </div>
        </a>

        <!-- åœ°æ”¿å­¦ãƒªã‚¹ã‚¯æŒ‡æ¨™ -->
        <a href="/geopolitics" class="glass-card price-card" style="text-decoration: none;">
            <div class="icon">ğŸŒ</div>
            <div class="label">åœ°æ”¿å­¦ãƒªã‚¹ã‚¯æŒ‡æ•°</div>
            <div class="price" style="color: var(--danger);">{{ risks.overall_index | default('78') }}</div>
            <span class="risk-level {{ risks.overall_level | default('high') }}">
                {{ risks.overall_label | default('HIGH') }}
            </span>
        </a>
    </div>

    <!-- ä»Šé€±ã®ã‚·ã‚°ãƒŠãƒ« -->
    {% if weekly and weekly.judgments %}
    <div class="glass-card gold-border" style="padding: 24px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 class="section-title" style="margin-bottom: 0;">
                <span class="icon">ğŸ¯</span>
                ä»Šé€±ã®ã‚·ã‚°ãƒŠãƒ«
            </h2>
            <a href="/weekly" class="btn-gold" style="font-size: 0.875rem; padding: 8px 16px;">
                è©³ç´°ã‚’è¦‹ã‚‹ â†’
            </a>
        </div>
        <div class="grid grid-4">
            {% for j in weekly.judgments %}
            <div class="glass-card" style="padding: 24px; text-align: center; border: 2px solid {% if j.judgment == 'BUY' %}var(--success){% elif j.judgment == 'SELL' %}var(--danger){% else %}var(--warning){% endif %};">
                <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 8px;">{{ j.symbol }}</p>
                <p style="font-size: 2.5rem; margin-bottom: 4px;">
                    {% if j.judgment == 'BUY' %}ğŸ“ˆ{% elif j.judgment == 'SELL' %}ğŸ“‰{% else %}â¸ï¸{% endif %}
                </p>
                <p style="font-size: 1.8rem; font-weight: 900; color: {% if j.judgment == 'BUY' %}var(--success){% elif j.judgment == 'SELL' %}var(--danger){% else %}var(--warning){% endif %};">
                    {{ j.judgment }}
                </p>
                <p style="font-size: 0.9rem; color: var(--gold); font-weight: 700; margin-top: 4px;">
                    ä¿¡é ¼åº¦ {{ j.confidence }}%
                </p>
                <!-- ä¿¡é ¼åº¦ãƒãƒ¼ -->
                <div style="margin-top: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; height: 4px;">
                    <div style="width: {{ j.confidence }}%; height: 4px; border-radius: 4px; background: {% if j.judgment == 'BUY' %}var(--success){% elif j.judgment == 'SELL' %}var(--danger){% else %}var(--warning){% endif %};"></div>
                </div>
                {% if j.rationale_short %}
                <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 10px; line-height: 1.4;">{{ j.rationale_short }}</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        <p style="font-size: 0.7rem; color: var(--text-muted); text-align: right; margin-top: 12px;">
            æ›´æ–°: {{ weekly.updated }}
        </p>
    </div>
    {% endif %}

    <!-- ãƒãƒ£ãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="grid grid-2">
        <!-- ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒ£ãƒ¼ãƒˆ -->
        <div class="glass-card" style="padding: 24px;">
            <h2 class="section-title">
                <span class="icon">ğŸ“ˆ</span>
                <span class="gold-gradient">Gold</span> ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ 
            </h2>
            <div class="tradingview-widget-container" style="width: 100%; height: 500px;">
                <div id="tradingview_gold" style="height: 100%; width: 100%;"></div>
            </div>
        </div>

        <!-- ã‚·ãƒ«ãƒãƒ¼ãƒãƒ£ãƒ¼ãƒˆ -->
        <div class="glass-card" style="padding: 24px;">
            <h2 class="section-title">
                <span class="icon">ğŸ“ˆ</span>
                <span class="silver-gradient">Silver</span> ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ 
            </h2>
            <div class="tradingview-widget-container" style="width: 100%; height: 500px;">
                <div id="tradingview_silver" style="height: 100%; width: 100%;"></div>
            </div>
        </div>
    </div>

    <!-- åœ°æ”¿å­¦ãƒªã‚¹ã‚¯ãƒãƒƒãƒ— -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸ—ºï¸</span>
            åœ°æ”¿å­¦ãƒªã‚¹ã‚¯ãƒãƒƒãƒ—
        </h2>
        <div class="grid grid-3">
            {% for region in risks.regions | default([
                {'name': 'ä¸­æ±ï¼ˆã‚¤ãƒ©ãƒ³-ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ï¼‰', 'level': 'critical', 'label': 'CRITICAL', 'summary': 'ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ã¨ã‚¤ãƒ©ãƒ³ã®ç·Šå¼µãŒç¶™ç¶šã€‚åŸæ²¹ãƒ»é‡‘ä¾¡æ ¼ã«ç›´æ¥å½±éŸ¿'},
                {'name': 'ã‚¦ã‚¯ãƒ©ã‚¤ãƒŠ-ãƒ­ã‚·ã‚¢', 'level': 'high', 'label': 'HIGH', 'summary': 'è† ç€çŠ¶æ…‹ãŒç¶šãã‚‚ã€ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚¹ã‚¯ã‚ã‚Š'},
                {'name': 'å°æ¹¾æµ·å³¡', 'level': 'high', 'label': 'HIGH', 'summary': 'ä¸­å›½ã®è»äº‹æ¼”ç¿’å¢—åŠ ã€‚åŠå°ä½“ä¾›çµ¦ãƒªã‚¹ã‚¯'},
                {'name': 'æ—¥æœ¬æ”¿æ²»', 'level': 'medium', 'label': 'MEDIUM', 'summary': 'é«˜å¸‚æ”¿æ¨©ã®é˜²è¡›æ”¿ç­–å¼·åŒ–ã€‚è»éœ€æ ªã«æ³¨ç›®'},
                {'name': 'åŒ—æœé®®', 'level': 'medium', 'label': 'MEDIUM', 'summary': 'ãƒŸã‚µã‚¤ãƒ«ç™ºå°„ç¶™ç¶šã€‚åœ°æ”¿å­¦çš„ç·Šå¼µè¦å› '},
                {'name': 'å—ã‚·ãƒŠæµ·', 'level': 'medium', 'label': 'MEDIUM', 'summary': 'ãƒ•ã‚£ãƒªãƒ”ãƒ³ã¨ã®æ‘©æ“¦ã€‚èˆªè¡Œã®è‡ªç”±ä½œæˆ¦ç¶™ç¶š'}
            ]) %}
            <div class="glass-card" style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h3 style="font-weight: 700; font-size: 1rem;">{{ region.name }}</h3>
                    <span class="risk-level {{ region.level }}">{{ region.label }}</span>
                </div>
                <p style="color: var(--text-secondary); font-size: 0.875rem; line-height: 1.5;">
                    {{ region.summary }}
                </p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- è»éœ€æ ªã‚¯ã‚¤ãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼ -->
    <div class="glass-card" style="padding: 24px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <h2 class="section-title" style="margin-bottom: 0;">
                <span class="icon">ğŸ›¡ï¸</span>
                è»éœ€æ ªã‚¦ã‚©ãƒƒãƒ
            </h2>
            <a href="/defense-stocks" class="btn-gold" style="font-size: 0.875rem; padding: 8px 16px;">
                è©³ç´°ã‚’è¦‹ã‚‹ â†’
            </a>
        </div>
        <div class="grid grid-4">
            {% if stocks and stocks.us %}
            {% for s in stocks.us[:2] %}
            <div class="glass-card" style="padding: 16px; text-align: center;">
                <p style="font-size: 0.75rem; color: var(--text-muted);">ğŸ‡ºğŸ‡¸ {{ s.ticker }}</p>
                <p style="font-size: 1.25rem; font-weight: 700;">{{ s.price }}</p>
                <p style="font-size: 0.875rem; color: {{ 'var(--success)' if '+' in s.change else 'var(--danger)' }};">{{ s.change }}</p>
            </div>
            {% endfor %}
            {% endif %}
            {% if stocks and stocks.jp %}
            {% for s in stocks.jp[:2] %}
            <div class="glass-card" style="padding: 16px; text-align: center;">
                <p style="font-size: 0.75rem; color: var(--text-muted);">ğŸ‡¯ğŸ‡µ {{ s.name }}</p>
                <p style="font-size: 1.25rem; font-weight: 700;">{{ s.price }}</p>
                <p style="font-size: 0.875rem; color: {{ 'var(--success)' if '+' in s.change else 'var(--danger)' }};">{{ s.change }}</p>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>

    <!-- ç®—å‘½å­¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
    <div class="glass-card" style="padding: 24px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <h2 class="section-title" style="margin-bottom: 0;">
                <span class="icon">ğŸ”®</span>
                ç®—å‘½å­¦ã‹ã‚‰ã®ç¤ºå”†
            </h2>
            <a href="/sanmei" class="btn-silver" style="font-size: 0.875rem; padding: 8px 16px;">
                è©³ç´°ã‚’è¦‹ã‚‹ â†’
            </a>
        </div>
        <div class="grid grid-2">
            <div style="padding: 16px; border-left: 3px solid var(--gold);">
                <h3 style="font-weight: 700; margin-bottom: 8px; color: var(--gold);">2026å¹´2æœˆã®é‹å‹¢</h3>
                <p style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6;">
                    ç”²å¯…æœˆã€‚æœ¨ã®æ°—ãŒå¼·ã¾ã‚Šã€æ–°ã—ã„å‹•ããŒå‡ºã‚„ã™ã„æ™‚æœŸã€‚åœ°æ”¿å­¦çš„ã«ã¯ã€Œå‹•ã€ã®æ°—é…ã€‚
                    é‡‘éŠ€ã¯èª¿æ•´å¾Œã®ä¸Šæ˜‡ãƒˆãƒ¬ãƒ³ãƒ‰ç¶™ç¶šã‚’ç¤ºå”†ã€‚
                </p>
            </div>
            <div style="padding: 16px; border-left: 3px solid var(--silver);">
                <h3 style="font-weight: 700; margin-bottom: 8px; color: var(--silver);">æ³¨ç›®ã‚¿ã‚¤ãƒŸãƒ³ã‚°</h3>
                <p style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6;">
                    2/4ï¼ˆç«‹æ˜¥ï¼‰ã€2/19ï¼ˆé›¨æ°´ï¼‰å‰å¾Œã¯ç›¸å ´ã®è»¢æ›ç‚¹ã«ãªã‚Šã‚„ã™ã„ã€‚
                    ç‰¹ã«2/15-20ã¯ç·Šå¼µãŒé«˜ã¾ã‚Šã‚„ã™ã„é…ç½®ã€‚
                </p>
            </div>
        </div>
    </div>

</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
<script type="text/javascript">
// ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒ£ãƒ¼ãƒˆ
new TradingView.widget({
    "container_id": "tradingview_gold",
    "symbol": "TVC:GOLD",
    "interval": "60",
    "timezone": "Asia/Tokyo",
    "theme": "dark",
    "style": "1",
    "locale": "ja",
    "toolbar_bg": "#1A1A2E",
    "enable_publishing": false,
    "hide_top_toolbar": false,
    "save_image": false,
    "height": 500,
    "width": "100%",
    "autosize": false
});

// ã‚·ãƒ«ãƒãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
new TradingView.widget({
    "container_id": "tradingview_silver",
    "symbol": "TVC:SILVER",
    "interval": "60",
    "timezone": "Asia/Tokyo",
    "theme": "dark",
    "style": "1",
    "locale": "ja",
    "toolbar_bg": "#1A1A2E",
    "enable_publishing": false,
    "hide_top_toolbar": false,
    "save_image": false,
    "height": 500,
    "width": "100%",
    "autosize": false
});
</script>
{% endblock %}
