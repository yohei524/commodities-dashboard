{% extends "base.html" %}

{% block title %}é€±æ¬¡åˆ¤æ–­ | Gold Experience{% endblock %}

{% block content %}
<div style="display: flex; flex-direction: column; gap: 32px;">

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="glass-card gold-border" style="padding: 32px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h1 style="font-size: 2rem; font-weight: 900; margin-bottom: 8px;">
                    <span>ğŸ¯</span> é€±æ¬¡ãƒˆãƒ¬ãƒ¼ãƒ‰åˆ¤æ–­
                </h1>
                <p style="color: var(--text-secondary);">
                    {{ data.week | default('2026å¹´1æœˆ27æ—¥ã€œ2æœˆ2æ—¥') }}
                </p>
            </div>
            <div style="text-align: right;">
                <p style="font-size: 0.8rem; color: var(--text-muted);">æœ€çµ‚æ›´æ–°</p>
                <p style="font-size: 1.25rem; font-weight: 700;">{{ data.updated | default('2026-01-30 09:00') }}</p>
            </div>
        </div>
    </div>

    <!-- ç·åˆåˆ¤æ–­ -->
    <div class="grid grid-3">
        {% for asset in data.judgments | default([
            {'symbol': 'GOLD', 'judgment': 'BUY', 'confidence': 75, 'target': '2850', 'stop': '2720', 'color': 'gold'},
            {'symbol': 'SILVER', 'judgment': 'BUY', 'confidence': 80, 'target': '33.00', 'stop': '29.50', 'color': 'silver'},
            {'symbol': 'WTI', 'judgment': 'HOLD', 'confidence': 50, 'target': '-', 'stop': '-', 'color': 'oil'}
        ]) %}
        <div class="glass-card" style="padding: 24px; text-align: center; border: 2px solid {% if asset.judgment == 'BUY' %}var(--success){% elif asset.judgment == 'SELL' %}var(--danger){% else %}var(--warning){% endif %};">
            <p style="font-size: 0.9rem; color: var(--text-muted);">{{ asset.symbol }}</p>
            <p style="font-size: 3rem; font-weight: 900; color: {% if asset.judgment == 'BUY' %}var(--success){% elif asset.judgment == 'SELL' %}var(--danger){% else %}var(--warning){% endif %};">
                {% if asset.judgment == 'BUY' %}ğŸ“ˆ è²·ã„{% elif asset.judgment == 'SELL' %}ğŸ“‰ å£²ã‚Š{% else %}â¸ï¸ æ§˜å­è¦‹{% endif %}
            </p>
            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 8px;">
                ç¢ºä¿¡åº¦: <strong style="color: var(--gold);">{{ asset.confidence }}%</strong>
            </p>
            <!-- ä¿¡é ¼åº¦ãƒãƒ¼ -->
            <div style="margin-top: 12px; background: rgba(255,255,255,0.1); border-radius: 4px; height: 4px;">
                <div style="width: {{ asset.confidence }}%; height: 4px; border-radius: 4px; background: {% if asset.judgment == 'BUY' %}var(--success){% elif asset.judgment == 'SELL' %}var(--danger){% else %}var(--warning){% endif %};"></div>
            </div>
            {% if asset.rationale_short %}
            <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 10px; line-height: 1.4;">{{ asset.rationale_short }}</p>
            {% endif %}
            {% if asset.judgment != 'HOLD' %}
            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(255,255,255,0.1);">
                <p style="font-size: 0.8rem;">
                    <span style="color: var(--success);">åˆ©ç¢º: {{ asset.target }}</span>
                    <span style="margin: 0 8px;">|</span>
                    <span style="color: var(--danger);">æåˆ‡: {{ asset.stop }}</span>
                </p>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <!-- ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æ -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸ“Š</span>
            ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æ
        </h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>éŠ˜æŸ„</th>
                    <th>ç¾åœ¨å€¤</th>
                    <th>MA(20)</th>
                    <th>MA(50)</th>
                    <th>RSI(14)</th>
                    <th>ã‚µãƒãƒ¼ãƒˆ</th>
                    <th>ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹</th>
                    <th>ãƒˆãƒ¬ãƒ³ãƒ‰</th>
                </tr>
            </thead>
            <tbody>
                {% for t in data.technicals | default([
                    {'symbol': 'GOLD', 'price': 2785, 'ma20': 2750, 'ma50': 2680, 'rsi': 62, 'support': 2720, 'resistance': 2850, 'trend': 'up'},
                    {'symbol': 'SILVER', 'price': 31.50, 'ma20': 30.20, 'ma50': 28.80, 'rsi': 58, 'support': 29.50, 'resistance': 33.00, 'trend': 'up'},
                    {'symbol': 'WTI', 'price': 78.50, 'ma20': 76.80, 'ma50': 74.50, 'rsi': 55, 'support': 72.00, 'resistance': 82.00, 'trend': 'neutral'}
                ]) %}
                <tr>
                    <td><span class="tag {% if t.symbol == 'GOLD' %}tag-gold{% elif t.symbol == 'SILVER' %}tag-silver{% else %}tag-oil{% endif %}">{{ t.symbol }}</span></td>
                    <td style="font-weight: 700;">{{ t.price }}</td>
                    <td style="color: {{ 'var(--success)' if t.price > t.ma20 else 'var(--danger)' }};">{{ t.ma20 }} {% if t.price > t.ma20 %}â†‘{% else %}â†“{% endif %}</td>
                    <td style="color: {{ 'var(--success)' if t.price > t.ma50 else 'var(--danger)' }};">{{ t.ma50 }} {% if t.price > t.ma50 %}â†‘{% else %}â†“{% endif %}</td>
                    <td style="color: {% if t.rsi > 70 %}var(--danger){% elif t.rsi < 30 %}var(--success){% else %}var(--text-primary){% endif %};">
                        {{ t.rsi }}
                        {% if t.rsi > 70 %}âš ï¸éç†±{% elif t.rsi < 30 %}âš ï¸å£²ã‚‰ã‚Œã™ã{% endif %}
                    </td>
                    <td style="color: var(--success);">{{ t.support }}</td>
                    <td style="color: var(--danger);">{{ t.resistance }}</td>
                    <td>
                        {% if t.trend == 'up' %}
                        <span style="color: var(--success); font-weight: 700;">ğŸ”¼ ä¸Šæ˜‡</span>
                        {% elif t.trend == 'down' %}
                        <span style="color: var(--danger); font-weight: 700;">ğŸ”½ ä¸‹é™</span>
                        {% else %}
                        <span style="color: var(--warning); font-weight: 700;">â¡ï¸ ä¸­ç«‹</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ãƒ•ã‚¡ãƒ³ãƒ€ãƒ¡ãƒ³ã‚¿ãƒ«è¦å›  -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸŒ</span>
            ä»Šé€±ã®ãƒ•ã‚¡ãƒ³ãƒ€ãƒ¡ãƒ³ã‚¿ãƒ«è¦å› 
        </h2>
        <div class="grid grid-2">
            <div style="padding: 20px; border-left: 3px solid var(--success);">
                <h3 style="font-weight: 700; color: var(--success); margin-bottom: 12px;">ä¸Šæ˜‡è¦å› </h3>
                <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                    {% for factor in data.bullish_factors | default([
                        'ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ãƒ»ã‚¤ãƒ©ãƒ³ç·Šå¼µç¶™ç¶šï¼ˆã‚»ãƒ¼ãƒ•ãƒ˜ã‚¤ãƒ–ãƒ³éœ€è¦ï¼‰',
                        'ä¸­å›½äººæ°‘éŠ€è¡Œã®é‡‘è³¼å…¥ç¶™ç¶š',
                        'FRBã®åˆ©ä¸‹ã’æœŸå¾…ï¼ˆ3æœˆæ®ãˆç½®ãã§ã‚‚å¹´å†…2å›äºˆæƒ³ï¼‰',
                        'å®Ÿè³ªé‡‘åˆ©ã®ä½ä¸‹å‚¾å‘'
                    ]) %}
                    <li>{{ factor }}</li>
                    {% endfor %}
                </ul>
            </div>
            <div style="padding: 20px; border-left: 3px solid var(--danger);">
                <h3 style="font-weight: 700; color: var(--danger); margin-bottom: 12px;">ä¸‹è½è¦å› </h3>
                <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                    {% for factor in data.bearish_factors | default([
                        'ãƒ‰ãƒ«é«˜ç¶™ç¶šï¼ˆDXY 104ä»˜è¿‘ï¼‰',
                        'ç±³å›½æ ªå¥½èª¿ï¼ˆãƒªã‚¹ã‚¯ã‚ªãƒ³ï¼‰',
                        '2800ãƒ‰ãƒ«ä»˜è¿‘ã§ã®åˆ©ç¢ºå£²ã‚Š',
                        'é€±æœ«ã®ãƒã‚¸ã‚·ãƒ§ãƒ³èª¿æ•´'
                    ]) %}
                    <li>{{ factor }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- ä»Šé€±ã®æ³¨ç›®ã‚¤ãƒ™ãƒ³ãƒˆ -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸ“…</span>
            ä»Šé€±ã®æ³¨ç›®ã‚¤ãƒ™ãƒ³ãƒˆ
        </h2>
        <div style="display: flex; flex-direction: column; gap: 12px;">
            {% for event in data.events | default([
                {'date': '1/30(æœ¨)', 'time': '22:30', 'event': 'ç±³GDPé€Ÿå ±å€¤(Q4)', 'impact': 'high', 'note': 'äºˆæƒ³+2.5%ã€‚ä¸ŠæŒ¯ã‚Œã§ãƒ‰ãƒ«é«˜â†’é‡‘ä¸‹è½ãƒªã‚¹ã‚¯'},
                {'date': '1/31(é‡‘)', 'time': '22:30', 'event': 'ç±³PCEãƒ‡ãƒ•ãƒ¬ãƒ¼ã‚¿ãƒ¼', 'impact': 'high', 'note': 'FRBã®æœ€é‡è¦æŒ‡æ¨™ã€‚äºˆæƒ³+2.6%ã€‚ä¸ŠæŒ¯ã‚Œæ³¨æ„'},
                {'date': '2/1(åœŸ)', 'time': '-', 'event': 'ä¸­å›½è£½é€ æ¥­PMI', 'impact': 'medium', 'note': 'æ™¯æ°—æ¸›é€Ÿç¢ºèªãªã‚‰é‡‘ã«è¿½ã„é¢¨'},
                {'date': '2/3(æœˆ)', 'time': '24:00', 'event': 'ISMè£½é€ æ¥­æ™¯æ³æŒ‡æ•°', 'impact': 'medium', 'note': 'äºˆæƒ³49.5ã€‚50å‰²ã‚Œç¶™ç¶šã§æ™¯æ°—æ‡¸å¿µ'}
            ]) %}
            <div style="display: flex; align-items: center; gap: 16px; padding: 16px; background: rgba(22, 33, 62, 0.5); border-radius: 8px;">
                <div style="min-width: 80px; text-align: center;">
                    <p style="font-weight: 700;">{{ event.date }}</p>
                    <p style="font-size: 0.8rem; color: var(--text-muted);">{{ event.time }}</p>
                </div>
                <span class="risk-level {{ event.impact }}">
                    {% if event.impact == 'high' %}é‡è¦{% else %}æ³¨ç›®{% endif %}
                </span>
                <div style="flex: 1;">
                    <p style="font-weight: 600;">{{ event.event }}</p>
                    <p style="font-size: 0.8rem; color: var(--text-secondary);">{{ event.note }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- ç®—å‘½å­¦ã®ç¤ºå”† -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸ”®</span>
            ç®—å‘½å­¦ã®ç¤ºå”†
        </h2>
        <div style="padding: 20px; background: rgba(212, 175, 55, 0.1); border-radius: 12px;">
            <p style="color: var(--text-secondary); line-height: 1.8;">
                {{ data.sanmei_note | default('å·±ä¸‘æœˆã®æœ€çµ‚é€±ã€‚åœŸã®æ°—ãŒå®‰å®šã‚’ã‚‚ãŸã‚‰ã™ãŒã€é€±æœ«ã®ç«‹æ˜¥ï¼ˆ2/4ï¼‰ã«å‘ã‘ã¦ã€Œå‹•ã€ã®æ°—é…ãŒå¼·ã¾ã‚‹ã€‚1/30-31ã¯ç›¸å ´ã®è»¢æ›ç‚¹ã«ãªã‚Šã‚„ã™ã„é…ç½®ã€‚æ…é‡ãªãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†ã‚’ã€‚') }}
            </p>
        </div>
    </div>

    <!-- ç§ã®åˆ¤æ–­æ ¹æ‹  -->
    <div class="glass-card" style="padding: 24px; border: 2px solid var(--gold);">
        <h2 class="section-title">
            <span class="icon">ğŸ’­</span>
            ä»Šé€±ã®åˆ¤æ–­æ ¹æ‹ ï¼ˆLINEé™å®šï¼‰
        </h2>
        <div style="display: flex; flex-direction: column; gap: 16px;">
            {% for asset in data.reasoning | default([
                {
                    'symbol': 'GOLD',
                    'reasoning': 'ä¸­æ±ãƒªã‚¹ã‚¯ç¶™ç¶šã§ã‚»ãƒ¼ãƒ•ãƒ˜ã‚¤ãƒ–ãƒ³éœ€è¦ã¯åº•å …ã„ã€‚ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ã‚‚MA(20)ä¸Šã€RSIéç†±ãªã—ã€‚2800çªç ´å¾Œã®æŠ¼ã—ç›®ã‚’ç‹™ã„ãŸã„ã€‚åˆ©ç¢ºã¯2850ã€æåˆ‡ã‚Šã¯2720ã€‚PCEãƒ‡ãƒ•ãƒ¬ãƒ¼ã‚¿ãƒ¼æ¬¡ç¬¬ã§æ€¥å¤‰å‹•ã‚ã‚Šå¾—ã‚‹ã®ã§ã€ç™ºè¡¨å‰ã«ãƒã‚¸ã‚·ãƒ§ãƒ³ç¸®å°æ¨å¥¨ã€‚'
                },
                {
                    'symbol': 'SILVER',
                    'reasoning': 'é‡‘éŠ€ãƒ¬ã‚·ã‚ª88ã¯å‰²å®‰ã€‚é‡‘ã®ä¸Šæ˜‡ã«è¿½éšã—ã‚„ã™ã„ã€‚ãƒœãƒ©ãŒé«˜ã„ã®ã§ã‚µã‚¤ã‚ºã¯æ§ãˆã‚ã«ã€‚33ãƒ‰ãƒ«çªç ´ã§åŠ é€Ÿã®å¯èƒ½æ€§ã€‚æåˆ‡ã‚Š29.50ã¯æ­»å®ˆã€‚'
                },
                {
                    'symbol': 'WTI',
                    'reasoning': 'ä¸­æ±ãƒªã‚¹ã‚¯ã¨ä¸–ç•ŒçµŒæ¸ˆæ¸›é€ŸãŒç¶±å¼•ãã€‚æ–¹å‘æ„Ÿãªã—ã€‚72-82ãƒ‰ãƒ«ã®ãƒ¬ãƒ³ã‚¸ã‚’æƒ³å®šã—ã€ãƒ–ãƒ¬ã‚¤ã‚¯å¾…ã¡ã€‚ä»Šé€±ã¯ãƒãƒ¼ãƒã‚¸æ¨å¥¨ã€‚'
                }
            ]) %}
            <div style="padding: 20px; background: rgba(22, 33, 62, 0.5); border-radius: 12px; border-left: 3px solid {% if asset.symbol == 'GOLD' %}var(--gold){% elif asset.symbol == 'SILVER' %}var(--silver){% else %}#D2691E{% endif %};">
                <h3 style="font-weight: 700; margin-bottom: 8px;">{{ asset.symbol }}</h3>
                <p style="color: var(--text-secondary); line-height: 1.7; font-size: 0.9rem;">{{ asset.reasoning }}</p>
            </div>
            {% endfor %}
        </div>
    </div>

</div>
{% endblock %}
