{% extends "base.html" %}

{% block title %}éå»æ¤œè¨¼ | Geopolitics Ã— Commodities{% endblock %}

{% block content %}
<div style="display: flex; flex-direction: column; gap: 32px;">

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="glass-card gold-border" style="padding: 32px;">
        <h1 style="font-size: 2rem; font-weight: 900; margin-bottom: 8px;">
            <span>ğŸ“š</span> éå»ã‚¤ãƒ™ãƒ³ãƒˆæ¤œè¨¼
        </h1>
        <p style="color: var(--text-secondary);">
            åœ°æ”¿å­¦ã‚¤ãƒ™ãƒ³ãƒˆã¨ä¾¡æ ¼å¤‰å‹•ã®å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿ + ç®—å‘½å­¦äºˆæ¸¬ã®æ¤œè¨¼
        </p>
    </div>

    <!-- éå»ã®åœ°æ”¿å­¦ã‚¤ãƒ™ãƒ³ãƒˆ -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸŒ</span>
            åœ°æ”¿å­¦ã‚¤ãƒ™ãƒ³ãƒˆã¨ä¾¡æ ¼å¤‰å‹•
        </h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>æ—¥ä»˜</th>
                    <th>ã‚¤ãƒ™ãƒ³ãƒˆ</th>
                    <th>é‡‘</th>
                    <th>éŠ€</th>
                    <th>åŸæ²¹</th>
                    <th>è»éœ€æ ª</th>
                    <th>æ•™è¨“</th>
                </tr>
            </thead>
            <tbody>
                {% for event in history.events | default([
                    {
                        'date': '2024-10-01',
                        'event': 'ã‚¤ãƒ©ãƒ³ã€ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ã«ãƒŸã‚µã‚¤ãƒ«æ”»æ’ƒ',
                        'gold': '+2.8%',
                        'silver': '+4.2%',
                        'oil': '+5.1%',
                        'defense': '+3.5%',
                        'lesson': 'ä¸­æ±ç·Šå¼µã¯é‡‘ãƒ»åŸæ²¹åŒæ™‚ä¸Šæ˜‡ã€‚åˆå‹•ãŒå¤§ãã„'
                    },
                    {
                        'date': '2024-04-13',
                        'event': 'ã‚¤ãƒ©ãƒ³ã€ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ã«ãƒ‰ãƒ­ãƒ¼ãƒ³æ”»æ’ƒ',
                        'gold': '+1.5%',
                        'silver': '+2.1%',
                        'oil': '+3.2%',
                        'defense': '+2.8%',
                        'lesson': 'é€±æœ«ã®æ”»æ’ƒâ†’æœˆæ›œçª“é–‹ã‘ã€‚ãƒã‚¸ã‚·ãƒ§ãƒ³æŒã¡è¶Šã—æ³¨æ„'
                    },
                    {
                        'date': '2023-10-07',
                        'event': 'ãƒãƒã‚¹ã€ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«æ”»æ’ƒ',
                        'gold': '+3.2%',
                        'silver': '+2.8%',
                        'oil': '+4.5%',
                        'defense': '+4.2%',
                        'lesson': 'çªç™ºã‚¤ãƒ™ãƒ³ãƒˆã¯åˆå‹•ã«ä¹—ã‚Œã‚‹ã‹ãŒå‹è² '
                    },
                    {
                        'date': '2022-02-24',
                        'event': 'ãƒ­ã‚·ã‚¢ã€ã‚¦ã‚¯ãƒ©ã‚¤ãƒŠä¾µæ”»',
                        'gold': '+3.5%',
                        'silver': '+5.2%',
                        'oil': '+8.0%',
                        'defense': '+6.5%',
                        'lesson': 'å¤§è¦æ¨¡æˆ¦äº‰ã¯å…¨ã‚³ãƒ¢ãƒ‡ã‚£ãƒ†ã‚£æ€¥é¨°ã€‚ãã®å¾Œã¯åè½æ³¨æ„'
                    },
                    {
                        'date': '2020-01-03',
                        'event': 'ç±³ã€ã‚½ãƒ¬ã‚¤ãƒãƒ‹å¸ä»¤å®˜æ®ºå®³',
                        'gold': '+2.4%',
                        'silver': '+1.8%',
                        'oil': '+4.0%',
                        'defense': '+3.0%',
                        'lesson': 'å ±å¾©æ‡¸å¿µã§æ€¥é¨°â†’å ±å¾©ãªã—ã§å…¨æˆ»ã—'
                    }
                ]) %}
                <tr>
                    <td>{{ event.date }}</td>
                    <td style="font-weight: 600; max-width: 200px;">{{ event.event }}</td>
                    <td style="color: var(--success); font-weight: 600;">{{ event.gold }}</td>
                    <td style="color: var(--success); font-weight: 600;">{{ event.silver }}</td>
                    <td style="color: var(--success); font-weight: 600;">{{ event.oil }}</td>
                    <td style="color: var(--success); font-weight: 600;">{{ event.defense }}</td>
                    <td style="font-size: 0.8rem; color: var(--text-secondary);">{{ event.lesson }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸ“Š</span>
            ã‚¤ãƒ™ãƒ³ãƒˆåˆ¥ å¹³å‡å¤‰å‹•ç‡
        </h2>
        <div class="grid grid-2">
            <div style="padding: 20px;">
                <h3 style="font-weight: 700; margin-bottom: 16px;">ä¸­æ±ç·Šå¼µï¼ˆã‚¤ãƒ©ãƒ³ãƒ»ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ï¼‰</h3>
                <table class="data-table">
                    <tr>
                        <td>é‡‘</td>
                        <td style="color: var(--success); font-weight: 700;">+2.5% (å¹³å‡)</td>
                    </tr>
                    <tr>
                        <td>éŠ€</td>
                        <td style="color: var(--success); font-weight: 700;">+3.2% (å¹³å‡)</td>
                    </tr>
                    <tr>
                        <td>åŸæ²¹</td>
                        <td style="color: var(--success); font-weight: 700;">+4.3% (å¹³å‡)</td>
                    </tr>
                    <tr>
                        <td>åˆå‹•å¾Œã®å‹•ã</td>
                        <td style="color: var(--warning);">3-5æ—¥ã§åŠå€¤æˆ»ã—å¤šã„</td>
                    </tr>
                </table>
            </div>
            <div style="padding: 20px;">
                <h3 style="font-weight: 700; margin-bottom: 16px;">å°æ¹¾é–¢é€£ï¼ˆä¸­å›½æ¼”ç¿’ãªã©ï¼‰</h3>
                <table class="data-table">
                    <tr>
                        <td>é‡‘</td>
                        <td style="color: var(--success); font-weight: 700;">+1.2% (å¹³å‡)</td>
                    </tr>
                    <tr>
                        <td>éŠ€</td>
                        <td style="color: var(--success); font-weight: 700;">+0.8% (å¹³å‡)</td>
                    </tr>
                    <tr>
                        <td>åŸæ²¹</td>
                        <td style="color: var(--warning); font-weight: 700;">Â±0.5%</td>
                    </tr>
                    <tr>
                        <td>ç‰¹å¾´</td>
                        <td style="color: var(--text-secondary);">åŠå°ä½“æ ªã¸ã®å½±éŸ¿ãŒå¤§</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <!-- ç®—å‘½å­¦äºˆæ¸¬ã®æ¤œè¨¼ -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">ğŸ”®</span>
            ç®—å‘½å­¦äºˆæ¸¬ã®æ¤œè¨¼
        </h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>äºˆæ¸¬æ—¥</th>
                    <th>äºˆæ¸¬å†…å®¹</th>
                    <th>å®Ÿéš›ã®çµæœ</th>
                    <th>åˆ¤å®š</th>
                    <th>ãƒ¡ãƒ¢</th>
                </tr>
            </thead>
            <tbody>
                {% for record in sanmei.records | default([
                    {
                        'date': '2025-12-22',
                        'prediction': 'å†¬è‡³å‰å¾Œã¯ç›¸å ´è»¢æ›ç‚¹ã€‚é‡‘ã¯ä¸Šæ˜‡ã—ã‚„ã™ã„',
                        'result': 'é‡‘2680â†’2750ãƒ‰ãƒ« (+2.6%)',
                        'verdict': 'hit',
                        'note': 'äºˆæ¸¬é€šã‚Šã€‚å†¬è‡³ã®è»¢æ›ç‚¹ã¯æœ‰åŠ¹'
                    },
                    {
                        'date': '2025-11-07',
                        'prediction': 'ç«‹å†¬ã€‚èª¿æ•´å±€é¢å…¥ã‚Šã‚„ã™ã„',
                        'result': 'é‡‘2750â†’2680ãƒ‰ãƒ« (-2.5%)',
                        'verdict': 'hit',
                        'note': 'äºˆæ¸¬é€šã‚Šèª¿æ•´ã€‚å­£ç¯€ã®ç¯€ç›®ã¯æ„è­˜ã•ã‚Œã‚‹'
                    },
                    {
                        'date': '2025-09-23',
                        'prediction': 'ç§‹åˆ†ã€‚ãƒˆãƒ¬ãƒ³ãƒ‰è»¢æ›ç‚¹',
                        'result': 'åŸæ²¹72â†’68ãƒ‰ãƒ« (-5.5%)',
                        'verdict': 'hit',
                        'note': 'åŸæ²¹ã¯äºˆæ¸¬é€šã‚Šã€‚é‡‘ã¯æ¨ªã°ã„ã§å¤–ã‚Œ'
                    },
                    {
                        'date': '2025-06-21',
                        'prediction': 'å¤è‡³ã€‚åœ°æ”¿å­¦ç·Šå¼µãƒ”ãƒ¼ã‚¯',
                        'result': 'ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ãƒ»ãƒ¬ãƒãƒãƒ³ç·Šå¼µæ¿€åŒ–',
                        'verdict': 'hit',
                        'note': 'å®Ÿéš›ã«ç·Šå¼µé«˜ã¾ã‚‹ã€‚é‡‘+4%'
                    },
                    {
                        'date': '2025-04-04',
                        'prediction': 'æ¸…æ˜ã€‚ç·Šå¼µç·©å’Œã®å…†ã—',
                        'result': 'åŸæ²¹æ€¥é¨°ï¼ˆOPECæ¸›ç”£ï¼‰',
                        'verdict': 'miss',
                        'note': 'OPECã®ã‚µãƒ—ãƒ©ã‚¤ã‚ºæ¸›ç”£ã¯èª­ã‚ãš'
                    }
                ]) %}
                <tr>
                    <td>{{ record.date }}</td>
                    <td style="max-width: 200px;">{{ record.prediction }}</td>
                    <td style="max-width: 200px;">{{ record.result }}</td>
                    <td>
                        {% if record.verdict == 'hit' %}
                        <span style="color: var(--success); font-weight: 700;">âœ… çš„ä¸­</span>
                        {% else %}
                        <span style="color: var(--danger); font-weight: 700;">âŒ å¤–ã‚Œ</span>
                        {% endif %}
                    </td>
                    <td style="font-size: 0.8rem; color: var(--text-secondary);">{{ record.note }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- ç®—å‘½å­¦ã®çš„ä¸­ç‡ -->
        <div style="margin-top: 24px; padding: 20px; background: rgba(212, 175, 55, 0.1); border-radius: 12px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h3 style="font-weight: 700; color: var(--gold);">ç®—å‘½å­¦äºˆæ¸¬ã®çš„ä¸­ç‡</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">éå»12ãƒ¶æœˆã®æ¤œè¨¼çµæœ</p>
                </div>
                <div style="text-align: right;">
                    <p style="font-size: 3rem; font-weight: 900; color: var(--gold);">{{ sanmei.hit_rate | default('72') }}%</p>
                    <p style="font-size: 0.9rem; color: var(--text-muted);">{{ sanmei.hits | default('18') }}çš„ä¸­ / {{ sanmei.total | default('25') }}äºˆæ¸¬</p>
                </div>
            </div>
        </div>
    </div>

    <!-- å­¦ã‚“ã æ•™è¨“ -->
    <div class="glass-card" style="padding: 24px; border: 2px solid var(--gold);">
        <h2 class="section-title">
            <span class="icon">ğŸ“</span>
            æ¤œè¨¼ã‹ã‚‰å¾—ãŸæ•™è¨“
        </h2>
        <div class="grid grid-2">
            <div style="padding: 20px;">
                <h3 style="font-weight: 700; color: var(--success); margin-bottom: 12px;">ã†ã¾ãã„ã£ãŸãƒ‘ã‚¿ãƒ¼ãƒ³</h3>
                <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                    {% for lesson in history.success_patterns | default([
                        'ä¸­æ±ç·Šå¼µæ¿€åŒ–ã®åˆå‹•ã«ä¹—ã‚‹ï¼ˆ1-2æ—¥ã§åˆ©ç¢ºï¼‰',
                        'ç¯€æ°—ï¼ˆç«‹æ˜¥ãƒ»å¤è‡³ãƒ»å†¬è‡³ï¼‰å‰å¾Œã®è»¢æ›ç‚¹ã‚’æ„è­˜',
                        'RSIéç†±ãªã— + åœ°æ”¿å­¦ãƒªã‚¹ã‚¯ = è²·ã„å®‰å¿ƒæ„Ÿ',
                        'é‡‘éŠ€ãƒ¬ã‚·ã‚ª90è¶…ãˆã§éŠ€è²·ã„'
                    ]) %}
                    <li>{{ lesson }}</li>
                    {% endfor %}
                </ul>
            </div>
            <div style="padding: 20px;">
                <h3 style="font-weight: 700; color: var(--danger); margin-bottom: 12px;">å¤±æ•—ã—ãŸãƒ‘ã‚¿ãƒ¼ãƒ³</h3>
                <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                    {% for lesson in history.failure_patterns | default([
                        'ç·Šå¼µç·©å’Œã‚’äºˆæƒ³ã—ã¦é€†å¼µã‚Šï¼ˆç¶™ç¶šã™ã‚‹å ´åˆå¤šã„ï¼‰',
                        'OPECãƒ»FOMCãªã©äºˆæ¸¬ä¸èƒ½ã‚¤ãƒ™ãƒ³ãƒˆå‰ã®ãƒã‚¸ã‚·ãƒ§ãƒ³',
                        'é€±æœ«æŒã¡è¶Šã—ã§æœˆæ›œçª“é–‹ã‘ã«è¢«å¼¾',
                        'åˆ©ç¢ºãŒæ—©ã™ã / æåˆ‡ã‚ŠãŒé…ã™ã'
                    ]) %}
                    <li>{{ lesson }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

</div>
{% endblock %}
