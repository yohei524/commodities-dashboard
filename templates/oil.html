{% extends "base.html" %}

{% block title %}原油分析 | Geopolitics × Commodities{% endblock %}

{% block content %}
<div style="display: flex; flex-direction: column; gap: 32px;">

    <!-- ヘッダー -->
    <div class="glass-card" style="padding: 32px; border: 2px solid #D2691E;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h1 style="font-size: 2rem; font-weight: 900; margin-bottom: 8px;">
                    <span>🛢️</span> <span style="color: #D2691E;">CRUDE OIL</span> 分析
                </h1>
                <p style="color: var(--text-secondary);">
                    原油価格と地政学リスク
                </p>
            </div>
            <div style="text-align: right;">
                <p style="font-size: 3rem; font-weight: 900; color: #D2691E;">${{ data.price_usd | default('78.50') }}</p>
                <p style="color: var(--danger); font-size: 1.25rem;">{{ data.change_pct | default('-0.8') }}%</p>
            </div>
        </div>
    </div>

    <!-- 価格詳細 -->
    <div class="grid grid-4">
        <div class="glass-card" style="padding: 20px; text-align: center;">
            <p style="color: var(--text-muted); font-size: 0.875rem;">WTI原油</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #D2691E;">${{ data.wti | default('78.50') }}/bbl</p>
        </div>
        <div class="glass-card" style="padding: 20px; text-align: center;">
            <p style="color: var(--text-muted); font-size: 0.875rem;">ブレント原油</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #D2691E;">${{ data.brent | default('82.30') }}/bbl</p>
        </div>
        <div class="glass-card" style="padding: 20px; text-align: center;">
            <p style="color: var(--text-muted); font-size: 0.875rem;">52週高値</p>
            <p style="font-size: 1.5rem; font-weight: 700;">${{ data.high_52w | default('95.00') }}</p>
        </div>
        <div class="glass-card" style="padding: 20px; text-align: center;">
            <p style="color: var(--text-muted); font-size: 0.875rem;">52週安値</p>
            <p style="font-size: 1.5rem; font-weight: 700;">${{ data.low_52w | default('65.00') }}</p>
        </div>
    </div>

    <!-- チャート -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">📈</span>
            リアルタイムチャート（WTI）
        </h2>
        <div class="tradingview-widget-container" style="width: 800px; height: 600px; margin: 0 auto;">
            <div id="tradingview_oil" style="height: 100%; width: 100%;"></div>
        </div>
    </div>

    <!-- 地政学リスクと原油 -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">🌍</span>
            地政学リスクと原油価格
        </h2>
        <div class="grid grid-2">
            <div style="padding: 20px; border-left: 3px solid var(--danger);">
                <h3 style="font-weight: 700; color: var(--danger); margin-bottom: 12px;">中東リスク</h3>
                <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                    <li><strong>ホルムズ海峡</strong>：世界の石油輸送の約20%が通過</li>
                    <li><strong>イラン制裁</strong>：供給減少リスク</li>
                    <li><strong>フーシ派攻撃</strong>：紅海の航行リスク</li>
                    <li><strong>サウジ施設</strong>：過去に攻撃で急騰</li>
                </ul>
            </div>
            <div style="padding: 20px; border-left: 3px solid var(--warning);">
                <h3 style="font-weight: 700; color: var(--warning); margin-bottom: 12px;">その他の供給リスク</h3>
                <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                    <li><strong>ロシア制裁</strong>：欧州向け供給減</li>
                    <li><strong>OPEC+減産</strong>：価格調整の動き</li>
                    <li><strong>リビア情勢</strong>：内戦リスク</li>
                    <li><strong>ベネズエラ</strong>：制裁の行方</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 需給分析 -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">📊</span>
            需給分析
        </h2>
        <div style="display: flex; flex-direction: column; gap: 16px;">
            <div class="grid grid-2">
                <div style="padding: 20px; background: rgba(40, 167, 69, 0.1); border-radius: 12px;">
                    <h3 style="font-weight: 700; color: var(--success); margin-bottom: 12px;">需要サイド</h3>
                    <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                        <li>中国経済の回復状況</li>
                        <li>世界経済の成長見通し</li>
                        <li>夏のドライブシーズン</li>
                        <li>航空需要の回復</li>
                    </ul>
                </div>
                <div style="padding: 20px; background: rgba(220, 53, 69, 0.1); border-radius: 12px;">
                    <h3 style="font-weight: 700; color: var(--danger); margin-bottom: 12px;">供給サイド</h3>
                    <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                        <li>OPEC+の生産調整</li>
                        <li>米シェールオイル生産</li>
                        <li>戦略備蓄の放出</li>
                        <li>制裁による供給制約</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- シナリオ分析 -->
    <div class="glass-card" style="padding: 24px;">
        <h2 class="section-title">
            <span class="icon">🎯</span>
            価格シナリオ
        </h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>シナリオ</th>
                    <th>条件</th>
                    <th>WTI予想</th>
                    <th>確率</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="font-weight: 600; color: var(--danger);">急騰シナリオ</td>
                    <td>中東で大規模紛争、ホルムズ海峡封鎖</td>
                    <td style="color: var(--danger);">$120-150</td>
                    <td>15%</td>
                </tr>
                <tr>
                    <td style="font-weight: 600; color: var(--warning);">上昇シナリオ</td>
                    <td>中東緊張継続、OPEC+追加減産</td>
                    <td style="color: var(--warning);">$90-100</td>
                    <td>30%</td>
                </tr>
                <tr>
                    <td style="font-weight: 600; color: var(--info);">現状維持</td>
                    <td>緊張と緩和が交互、需給均衡</td>
                    <td style="color: var(--info);">$75-85</td>
                    <td>40%</td>
                </tr>
                <tr>
                    <td style="font-weight: 600; color: var(--success);">下落シナリオ</td>
                    <td>中東和平、世界経済減速</td>
                    <td style="color: var(--success);">$60-70</td>
                    <td>15%</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- 私の見解 -->
    <div class="glass-card" style="padding: 24px; border: 2px solid #D2691E;">
        <h2 class="section-title">
            <span class="icon">💭</span>
            私の見解（LINE限定）
        </h2>
        <div style="padding: 20px; background: rgba(210, 105, 30, 0.05); border-radius: 12px;">
            <p style="color: var(--text-primary); line-height: 1.8;">
                {{ data.my_view | default('原油は70-90ドルのレンジを想定。中東リスクがあるが、世界経済の減速懸念が上値を抑える。ホルムズ海峡リスクが顕在化すれば100ドル超えもありうるが、基本シナリオは現状維持。地政学リスクに敏感なので、中東のニュースには要注目。') }}
            </p>
        </div>
    </div>

</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
<script type="text/javascript">
new TradingView.widget({
    "container_id": "tradingview_oil",
    "symbol": "TVC:USOIL",
    "interval": "D",
    "timezone": "Asia/Tokyo",
    "theme": "dark",
    "style": "1",
    "locale": "ja",
    "toolbar_bg": "#1A1A2E",
    "enable_publishing": false,
    "hide_top_toolbar": false,
    "save_image": false,
    "height": 600,
    "width": 800,
    "autosize": false
});
</script>
{% endblock %}
